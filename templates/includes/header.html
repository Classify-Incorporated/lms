{% load static %}
<!-- Navbar -->
<nav class="main-header navbar navbar-expand">
  <!-- Left navbar links -->
  <ul class="navbar-nav">
    <li class="nav-item">
      <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars text-dark"></i></a>
    </li>
  </ul>

  <!-- Right navbar links -->
  <ul class="navbar-nav ml-auto">
    <!-- Notifications Dropdown Menu -->
    <li class="nav-item dropdown">
      <a class="nav-link" data-toggle="dropdown" href="#">
        <i class="far fa-bell text-dark"></i>
        <span class="badge badge-danger navbar-badge">
          {% if unread_notifications_count > 0 %}
            {{ unread_notifications_count }}
          {% else %}
            0
          {% endif %}
        </span>
      </a>
      <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
        <span class="dropdown-item dropdown-header">
          {% if unread_notifications_count > 0 %}
            {{ unread_notifications_count }} Notifications
          {% else %}
            No new notifications
          {% endif %}
        </span>
        <div class="dropdown-divider"></div>
        <a href="#" class="dropdown-item dropdown-footer">See All Notifications</a>
      </div>
    </li>

    <!-- Messages Dropdown Menu -->
    <li class="nav-item dropdown">
      <a class="nav-link" data-toggle="dropdown" href="#">
        <i class="far fa-comment-alt text-dark"></i>
        <span class="badge badge-danger navbar-badge">
          {% if unread_messages_count > 0 %}
            {{ unread_messages_count }}
          {% else %}
            0
          {% endif %}
        </span>
      </a>
      <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
        <h6 class="dropdown-header">Message Center</h6>
        {% if unread_messages_count > 0 %}
          <p class="dropdown-item text-center small text-white font-weight-bold" style="background-color: #dc3545;">
            <i class="fas fa-envelope-open-text"></i> New messages! Please check your inbox.
          </p>
        {% else %}
          <p class="dropdown-item text-center small text-gray-500">
            <i class="fas fa-inbox"></i> No new messages.
          </p>
        {% endif %}
      </div>
    </li>

    <!-- User Dropdown Menu -->
    <li class="nav-item dropdown">
      <a class="nav-link" data-toggle="dropdown" href="#" style="display: flex; align-items: center;">
        <span class="text-dark">Hi, {{ request.user.first_name }}</span>
        <img class="img-profile rounded-circle"
          src="{% if request.user.profile.student_photo %}
            {{ request.user.profile.student_photo.url }}
          {% else %}
            {% static 'img/undraw_profile.svg' %}
          {% endif %}"
          alt="User Image"
          style="width: 30px; height: 30px; margin-left: 10px; vertical-align: middle;" />
        <i class="fas fa-caret-down text-dark ml-2"></i>
      </a>
      <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
        <a href="{% url 'viewProfile' request.user.id %}" class="dropdown-item"><i class="fas fa-user-cog mr-2"></i> Profile Settings</a>
        <a class="dropdown-item" href="#" id="settingsDropdown" role="button" data-toggle="modal" data-target="#settingsModal"><i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i> Settings</a>
        <div class="dropdown-divider"></div>
        <a href="#" class="dropdown-item" data-toggle="modal" data-target="#logoutModal"><i class="fas fa-sign-out-alt mr-2"></i> Logout</a>
      </div>
    </li>
  </ul>
</nav>
<!-- /.navbar -->

<!-- Settings Modal -->
<div class="modal right fade" id="settingsModal" tabindex="-1" role="dialog" aria-labelledby="settingsModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="settingsModalLabel">System Settings</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
        <div class="p-3">
          <div class="form-group">
            <div class="custom-control custom-checkbox">
              <input class="custom-control-input" type="checkbox" id="darkMode" />
              <label for="darkMode" class="custom-control-label">Dark Mode</label>
            </div>
          </div>
          <!-- Additional settings fields -->
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Logout Confirmation Modal -->
<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="logoutModalLabel">Confirm Logout</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">Are you sure you want to logout?</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <a href="{% url 'sign_out' %}" class="btn btn-primary">Logout</a>
      </div>
    </div>
  </div>
</div>
