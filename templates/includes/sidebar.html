{% load static %}
{% load permissions %}

<!-- Main Sidebar Container -->
<aside class="main-sidebar sidebar-dark-primary custom-sidebar elevation-4 sidebar-no-expand">
  <!-- Brand Logo -->
  <a href="{% url 'dashboard' %}" class="brand-link" style="display: flex; align-items: center;">
    <img src="{% static 'assets/dist/images/gsu_logo.png' %}" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" />
    <span class="brand-text font-weight-bolder">GUIMARAS STATE UNIVERSITY</span>
  </a>

  <!-- Sidebar -->
  <div class="sidebar">
    <br />
    <!-- SidebarSearch Form -->
    <div class="form-inline">
      <div class="input-group" data-widget="sidebar-search">
        <input class="form-control form-control-sidebar" type="search" placeholder="Search" aria-label="Search" />
        <div class="input-group-append">
          <button class="btn btn-sidebar"><i class="fas fa-search fa-fw"></i></button>
        </div>
      </div>
    </div>

    <!-- Sidebar Menu -->
    <nav class="mt-2">
      <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
        <!-- Calendar -->
        <li class="nav-item">
          <a href="{% url 'dashboard' %}" class="nav-link">
            <i class="ion ion-home nav-icon"></i>
            <p>Dashboard</p>
          </a>
        </li>
      
        <!-- Profile Section (Permission check) -->
        {% if user|has_perm:'accounts.view_profile' %}
          <li class="nav-item">
            <a href="{% url 'viewProfile' request.user.id %}" class="nav-link">
              <i class="ion ion-ios-person nav-icon"></i>
              <p>{{ request.user.first_name|title }} {{ request.user.last_name|title }}</p>
            </a>
          </li>
        {% endif %}

        <!-- Calendar -->
        <li class="nav-item">
          <a href="{% url 'calendars' %}" class="nav-link">
            <i class="ion ion-ios-calendar nav-icon"></i>
            <p>Calendar</p>
          </a>
        </li>

        <!-- Messages (Permission check) -->
        {% if user|has_perm:'message.view_message' %}
          <li class="nav-item">
            <a href="{% url 'inbox' %}" class="nav-link">
              <i class="ion ion-chatbox nav-icon"></i>
              <p>Messages</p>
              {% if unread_messages_count > 0 %}
                <span class="badge badge-danger">{{ unread_messages_count }}</span>
              {% endif %}
            </a>
          </li>
        {% endif %}

        <!-- Teaching Section -->
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="ion ion-ios-bookmarks-outline nav-icon"></i>
            <p>
              Teaching
              <i class="ion ion-chevron-down right"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            {% if user|has_perm:'course.view_course' %}
              <li class="nav-item">
                <a href="{% url 'SubjectList' %}" class="nav-link">
                  <i class="ion ion-ios-book nav-icon"></i>
                  <p>Subjects</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'gradebookcomponent.view_gradebookcomponents' %}
              <li class="nav-item">
                <a href="{% url 'studentTotalScoreForActivity' %}" class="nav-link">
                  <i class="ion ion-android-checkmark-circle nav-icon"></i>
                  <p>Grades</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'subject.view_subject' %}
              <li class="nav-item">
                <a href="{% url 'subject' %}" class="nav-link">
                  <i class="ion ion-ios-book nav-icon"></i>
                  <p>Subject List</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'subject.view_subject' %}
              <li class="nav-item">
                <a href="{% url 'progressList' %}" class="nav-link">
                  <i class="ion ion-stats-bars nav-icon"></i>
                  <p>Activity Progress</p>
                </a>
              </li>
            {% endif %}
          </ul>
        </li>

        <!-- Enroll Students -->
        {% if user|has_perm:'course.view_subjectenrollment' %}
          <li class="nav-item">
            <a href="{% url 'subjectEnrollmentList' %}" class="nav-link">
              <i class="ion ion-ios-personadd nav-icon"></i>
              <p>Enroll Students</p>
            </a>
          </li>
        {% endif %}

        <!-- Settings Section -->
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="ion ion-ios-cog nav-icon"></i>
            <p>
              Settings
              <i class="ion ion-chevron-down right"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            {% if user|has_perm:'roles.view_role' %}
              <li class="nav-item">
                <a href="{% url 'roleList' %}" class="nav-link">
                  <i class="ion ion-ios-people nav-icon"></i>
                  <p>Role</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'course.view_semester' %}
              <li class="nav-item">
                <a href="{% url 'activityTypeList' %}" class="nav-link">
                  <i class="ion ion-ios-albums-outline nav-icon"></i>
                  <p>Activity Type</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'course.view_semester' %}
              <li class="nav-item">
                <a href="{% url 'semesterList' %}" class="nav-link">
                  <i class="ion ion-ios-calendar nav-icon"></i>
                  <p>Semester</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'subject.view_subject' %}
              <li class="nav-item">
                <a href="{% url 'viewGradeBookComponents' %}" class="nav-link">
                  <i class="ion ion-ios-pie-outline nav-icon"></i>
                  <p>Subject Percentage</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'subject.view_subject' %}
              <li class="nav-item">
                <a href="{% url 'subGradebook' %}" class="nav-link">
                  <i class="ion ion-ios-pie nav-icon"></i>
                  <p>Subject Sub Percentage</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'course.view_term' %}
              <li class="nav-item">
                <a href="{% url 'termList' %}" class="nav-link">
                  <i class="ion ion-ios-calendar nav-icon"></i>
                  <p>Term</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'subject.view_subject' %}
              <li class="nav-item">
                <a href="{% url 'termBookList' %}" class="nav-link">
                  <i class="ion ion-podium nav-icon"></i>
                  <p>Term Percentage</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'course.view_semester' %}
              <li class="nav-item">
                <a href="{% url 'student' %}" class="nav-link">
                  <i class="ion ion-ios-people nav-icon"></i>
                  <p>Student List</p>
                </a>
              </li>
            {% endif %}
            {% if user|has_perm:'course.view_semester' %}
              <li class="nav-item">
                <a href="{% url 'staff_list' %}" class="nav-link">
                  <i class="ion ion-ios-briefcase nav-icon"></i>
                  <p>Staff List</p>
                </a>
              </li>
            {% endif %}
          </ul>
        </li>
      </ul>
    </nav>
    <!-- /.sidebar-menu -->
  </div>
  <!-- /.sidebar -->
</aside>
